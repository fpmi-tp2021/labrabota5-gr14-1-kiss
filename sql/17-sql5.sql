select * from pilots inner join (select helicopters.number as hn, helicopters.brand from Helicopters inner join (select max(num_flights), sum(cost) as total, brand as b from (select count(Flights.id) as num_flights, Flights.cost as cost, Helicopters.brand as brand from Flights inner join Helicopters on Flights.helicopter_number = Helicopters.number group by brand)) on helicopters.brand = b) on pilots.helicopter_number = hn group by pilots.surname;
