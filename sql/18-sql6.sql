select Flights.date, Flights.weight, Flights.cost, h from flights inner join (select h,max(total) from (select sum(fc) as total, hn as h from (select Pilots.surname as s, sum(Flights.cost) as fc, Flights.helicopter_number as hn FROM Pilots INNER JOIN Flights ON Pilots.helicopter_number = Flights.helicopter_number GROUP BY Pilots.surname) GROUP BY hn)) ON flights.helicopter_number = h;
